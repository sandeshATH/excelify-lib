{"version":3,"file":"devath-excelify.mjs","sources":["../../../projects/excelify/src/lib/excelify.component.ts","../../../projects/excelify/src/lib/excelify.component.html","../../../projects/excelify/src/lib/excelify.module.ts","../../../projects/excelify/src/public-api.ts","../../../projects/excelify/src/devath-excelify.ts"],"sourcesContent":["import { Component, Input, OnChanges, SimpleChanges, ViewChild, AfterViewInit, ElementRef } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { HotTableModule, HotTableComponent, HotTableRegisterer } from '@handsontable/angular';\r\nimport Handsontable from 'handsontable';\r\nimport { HyperFormula } from 'hyperformula';\r\nimport * as XLSX from 'xlsx';\r\nimport { saveAs } from 'file-saver';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\n@Component({\n  selector: 'eq-excelify',\n  standalone: true,\n  imports: [CommonModule, HotTableModule, FormsModule],\n  templateUrl: './excelify.component.html',\n  styleUrls: ['./excelify.component.scss'],\n})\nexport class ExcelifyComponent implements AfterViewInit {\n  excelData: any[][] = [];\r\n\r\n  @Input() griddata: any;\r\n\r\n  private workbook?: XLSX.WorkBook;\r\n  sheetNames: string[] = [];\r\n  selectedSheet = '';\r\n\r\n  // HyperFormula engine instance (REQUIRED for formulas)\r\n  private hf = HyperFormula.buildEmpty({ licenseKey: 'gpl-v3' });\r\n  formulas: any = { engine: this.hf };\r\n// @ts-ignore\r\n  // Show insert/delete row/col etc. in context menu\r\n  contextMenu: Handsontable.contextMenu.Settings['items'] | boolean = [\r\n    'row_above',\r\n    'row_below',\r\n    'col_left',\r\n    'col_right',\r\n    'remove_row',\r\n    'remove_col',\r\n    '---------',\r\n    'undo',\r\n    'redo',\r\n    // 'copy',  if you want to enable a copy cut \r\n    // 'cut',\r\n    'alignment',\r\n  ];\r\n\r\n  // Handsontable license (dev/eval)\r\n  licenseKey = 'non-commercial-and-evaluation';\r\n\r\n  @Input() data?: any[];\r\n  @Input() columns?: { field: string; header?: string }[];\r\n  @Input() sheetName?: string;\r\n  @Input() hideUpload = false;\r\n  // Exclude columns by field or header text (case-insensitive)\r\n  @Input() excludeColumns: string[] = [];\r\n  // Constrained container size (customizable by parent)\r\n  @Input() containerHeight: string = '70vh';\r\n  @Input() containerWidth: string = '100%';\r\n  // Number of top rows to treat as headers (not sortable)\r\n  @Input() headerRows: number = 1;\r\n  \r\n  @ViewChild('hotRef', { static: false }) hotComponent?: HotTableComponent;\r\n  private hot?: Handsontable;\r\n  private hotRegisterer = new HotTableRegisterer();\r\n  hotId = 'excelifyHot';\n  selectedRow = 0;\n  selectedCol = 0;\n  nameBox = 'A1';\n  formulaText = '';\n  selectionStats: { sum: number; average: number | null; numericCount: number; count: number; hasNonNumeric: boolean } = {\n    sum: 0,\n    average: null,\n    numericCount: 0,\n    count: 0,\n    hasNonNumeric: false,\n  };\n  // Find panel state\n  showFind = false;\n  findQuery = '';\n  findCaseSensitive = false;\n  findResults: { row: number; col: number }[] = [];\n  currentFindIndex = 0;\n  @ViewChild('findInput') findInput?: ElementRef<HTMLInputElement>;\n  private lastSelection: { r1: number; c1: number; r2: number; c2: number } | null = null;\n  replaceText = '';\n\r\n  ngAfterViewInit(): void {\r\n    this.hot = this.hotRegisterer.getInstance(this.hotId) as Handsontable | undefined;\r\n    if (!this.hot) {\r\n      this.hot = (this.hotComponent as any)?.hotInstance as Handsontable | undefined;\r\n    }\r\n    if (this.hot) {\r\n      this.hot.addHook('afterSelection', (r: number, c: number, r2?: number, c2?: number) => {\n        this.handleSelectionChange(r, c, r2, c2);\n      });\n      this.hot.addHook('afterSelectionEnd', (r: number, c: number, r2?: number, c2?: number) => {\n        this.handleSelectionChange(r, c, r2, c2);\n      });\n      this.hot.addHook('afterOnCellMouseDown', () => this.syncSelectionFromLastRange());\n      this.hot.addHook('afterOnCellMouseUp', () => this.syncSelectionFromLastRange());\n      this.hot.addHook('afterChange', () => {\n        this.updateSelection(this.selectedRow, this.selectedCol);\n      });\n      // Alt+= autosum shortcut, Ctrl/Cmd+F open Find, Esc close Find\r\n      this.hot.addHook('beforeKeyDown', (e: KeyboardEvent) => {\r\n        if (!e) return;\r\n        const key = (e as any).key as string;\r\n        const code = (e as any).code as string;\r\n        // Block copy/cut shortcuts inside the grid\r\n        const isCtrlLike = (e as any).ctrlKey || (e as any).metaKey;\r\n        const k = (key || '').toLowerCase();\r\n        if (isCtrlLike && (k === 'c' || code === 'KeyC' || key === 'Insert')) {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n          return;\r\n        }\r\n        if (isCtrlLike && (k === 'x' || code === 'KeyX')) {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n          return;\r\n        }\r\n        if ((e as any).altKey && (key === '=' || code === 'Equal')) {\r\n          e.preventDefault();\r\n          this.addSumOverSelection();\r\n          return;\r\n        }\r\n        if (((e as any).ctrlKey || (e as any).metaKey) && (key?.toLowerCase() === 'f')) {\r\n          e.preventDefault();\r\n          this.openFindPanel();\r\n          return;\r\n        }\r\n        if (key === 'Escape' && this.showFind) {\r\n          e.preventDefault();\r\n          this.closeFindPanel();\r\n        }\r\n      });\r\n\r\n      // Block programmatic copy/cut from Handsontable clipboard pipeline\r\n      this.hot.addHook('beforeCopy', () => false);\r\n      this.hot.addHook('beforeCut', () => false);\r\n\r\n      // Sort only data rows, keep the first `headerRows` at the top\r\n      this.hot.addHook('beforeColumnSort', (_currentCfg: any, destinationCfg: any) => {\r\n        const cfg = Array.isArray(destinationCfg) ? destinationCfg[0] : destinationCfg;\r\n        if (!cfg || cfg.column == null) return; // allow default if unknown\r\n        const colIndex = typeof cfg.column === 'number' ? cfg.column : (cfg.column?.visualIndex ?? cfg.column);\r\n        const order: 'asc' | 'desc' = (cfg.sortOrder === 'desc') ? 'desc' : 'asc';\r\n        try {\r\n          this.sortDataPreservingHeader(colIndex, order);\r\n        } catch (e) {\r\n          console.warn('Custom sort failed, falling back to default', e);\r\n          return; // default will proceed\r\n        }\r\n        return false; // cancel default sorting since we applied our own\r\n      });\r\n    }\r\n  }\r\n\r\n  // Sorts rows below `headerRows` by the given column, keeping header rows unchanged\r\n  private sortDataPreservingHeader(colIndex: number, order: 'asc' | 'desc') {\r\n    const data = this.excelData || [];\r\n    const headerCount = Math.max(0, Math.min(this.headerRows, data.length));\r\n    if (data.length <= headerCount) return;\r\n    const head = data.slice(0, headerCount);\r\n    const body = data.slice(headerCount);\r\n    const collator = new Intl.Collator(undefined, { numeric: true, sensitivity: 'base' });\r\n    const cmp = (a: any, b: any) => {\r\n      const va = a?.[colIndex];\r\n      const vb = b?.[colIndex];\r\n      if (va == null && vb == null) return 0;\r\n      if (va == null) return 1; // nulls last\r\n      if (vb == null) return -1;\r\n      const na = typeof va === 'number' ? va : Number(va);\r\n      const nb = typeof vb === 'number' ? vb : Number(vb);\r\n      let res: number;\r\n      if (!Number.isNaN(na) && !Number.isNaN(nb)) res = na - nb; else res = collator.compare(String(va), String(vb));\r\n      return order === 'asc' ? res : -res;\r\n    };\r\n    body.sort(cmp);\r\n    this.excelData = [...head, ...body];\r\n    // Ensure Handsontable re-renders with updated data\r\n    setTimeout(() => this.hot?.render());\r\n  }\r\n\r\n  private colToLetter(col: number): string {\r\n    let s = '';\r\n    let n = col + 1;\r\n    while (n > 0) {\r\n      const mod = (n - 1) % 26;\r\n      s = String.fromCharCode(65 + mod) + s;\r\n      n = Math.floor((n - mod) / 26);\r\n    }\r\n    return s;\r\n  }\r\n\r\n  private handleSelectionChange(r1: number, c1: number, r2?: number, c2?: number) {\n    const endRow = r2 ?? r1;\n    const endCol = c2 ?? c1;\n    this.lastSelection = {\n      r1: Math.min(r1, endRow),\n      c1: Math.min(c1, endCol),\n      r2: Math.max(r1, endRow),\n      c2: Math.max(c1, endCol),\n    };\n    this.updateSelection(r1, c1);\n  }\n\n  private updateSelection(row: number, col: number) {\n    this.selectedRow = row;\n    this.selectedCol = col;\n    this.nameBox = `${this.colToLetter(col)}${row + 1}`;\n    const src = this.hot?.getSourceDataAtCell(row, col) as any;\n    this.formulaText = src == null ? '' : String(src);\n    this.recalculateSelectionStats();\n  }\n\n  private syncSelectionFromLastRange() {\n    if (!this.hot) return;\n    // @ts-ignore - depending on HOT version this may not be typed\n    const range = this.hot.getSelectedRangeLast?.();\n    if (!range) return;\n    this.handleSelectionChange(range.from.row, range.from.col, range.to.row, range.to.col);\n  }\n\n  private recalculateSelectionStats() {\n    if (!this.hot) {\n      this.selectionStats = { sum: 0, average: null, numericCount: 0, count: 0, hasNonNumeric: false };\n      return;\n    }\n    let sum = 0;\n    let numericCount = 0;\n    let populatedCount = 0;\n    let hasNonNumeric = false;\n    this.forEachCellInSelection((r, c) => {\n      if (r == null || c == null) return;\n      const val = this.hot!.getDataAtCell(r, c);\n      if (!this.isValueEmpty(val)) populatedCount++;\n      const numeric = this.coerceToNumber(val);\n      if (numeric != null) {\n        sum += numeric;\n        numericCount++;\n      } else if (!this.isValueEmpty(val)) {\n        hasNonNumeric = true;\n      }\n    });\n    this.selectionStats = {\n      sum: hasNonNumeric ? 0 : (numericCount ? sum : 0),\n      average: !hasNonNumeric && numericCount ? sum / numericCount : null,\n      numericCount,\n      count: populatedCount,\n      hasNonNumeric,\n    };\n  }\n\n  private coerceToNumber(value: any): number | null {\n    if (value === '' || value === null || value === undefined) return null;\n    if (typeof value === 'number' && Number.isFinite(value)) return value;\n    const parsed = Number(value);\n    return Number.isFinite(parsed) ? parsed : null;\n  }\n\n  private isValueEmpty(value: any): boolean {\n    if (value === null || value === undefined) return true;\n    if (typeof value === 'string') return value.trim() === '';\n    return false;\n  }\n\r\n  applyFormulaBar() {\r\n    if (!this.hot) return;\r\n    this.hot.setDataAtCell(this.selectedRow, this.selectedCol, this.formulaText);\r\n  }\r\n\r\n  // ===== Excel-like toolbar actions =====\r\n  private forEachCellInSelection(cb: (r: number, c: number) => void) {\n    if (!this.hot) return;\n    // @ts-ignore - getSelectedRange may be typed loosely depending on version\n    const ranges = this.hot.getSelectedRange?.() || [];\n    if (ranges.length) {\n      ranges.forEach((range: any) => {\n        const r1 = Math.min(range.from.row, range.to.row);\n        const r2 = Math.max(range.from.row, range.to.row);\n        const c1 = Math.min(range.from.col, range.to.col);\n        const c2 = Math.max(range.from.col, range.to.col);\n        for (let r = r1; r <= r2; r++) {\n          for (let c = c1; c <= c2; c++) {\n            cb(r, c);\n          }\n        }\n      });\n      return;\n    }\n    if (this.lastSelection) {\n      for (let r = this.lastSelection.r1; r <= this.lastSelection.r2; r++) {\n        for (let c = this.lastSelection.c1; c <= this.lastSelection.c2; c++) {\n          cb(r, c);\n        }\n      }\n      return;\n    }\n    cb(this.selectedRow, this.selectedCol);\n  }\n\r\n  private updateClassOnSelection(addClasses: string[] = [], removeClasses: string[] = []) {\r\n    if (!this.hot) return;\r\n    const addSet = new Set(addClasses.filter(Boolean));\r\n    const removeSet = new Set(removeClasses.filter(Boolean));\r\n    this.forEachCellInSelection((r, c) => {\r\n      const meta = this.hot!.getCellMeta(r, c) as any;\r\n      const existing = (meta.className || '').split(/\\s+/).filter(Boolean);\r\n      let set = new Set(existing);\r\n      removeSet.forEach(cls => set.delete(cls));\r\n      addSet.forEach(cls => set.add(cls));\r\n      const next = Array.from(set).join(' ');\r\n      this.hot!.setCellMeta(r, c, 'className', next);\r\n    });\r\n    this.hot.render();\r\n  }\r\n\r\n  toggleBold() {\r\n    if (!this.hot) return;\r\n    // Simple toggle: if first cell has htBold then remove, else add\r\n    const meta = this.hot.getCellMeta(this.selectedRow, this.selectedCol) as any;\r\n    const has = (meta.className || '').split(/\\s+/).includes('htBold');\r\n    if (has) this.updateClassOnSelection([], ['htBold']); else this.updateClassOnSelection(['htBold']);\r\n  }\r\n\r\n  align(where: 'left' | 'center' | 'right') {\r\n    const map: any = { left: 'htLeft', center: 'htCenter', right: 'htRight' };\r\n    this.updateClassOnSelection([map[where]], ['htLeft', 'htCenter', 'htRight']);\r\n  }\r\n\r\n  toggleWrap() {\r\n    if (!this.hot) return;\r\n    const meta = this.hot.getCellMeta(this.selectedRow, this.selectedCol) as any;\r\n    const has = (meta.className || '').split(/\\s+/).includes('htWrap');\r\n    if (has) this.updateClassOnSelection([], ['htWrap']); else this.updateClassOnSelection(['htWrap']);\r\n  }\r\n\r\n  // ===== Quick functions based on current selection =====\r\n  private getFirstSelectionRange() {\r\n    // @ts-ignore\r\n    const ranges = this.hot?.getSelectedRange?.();\r\n    if (!ranges || !ranges.length) return null;\r\n    const r = ranges[0];\r\n    const r1 = Math.min(r.from.row, r.to.row);\r\n    const r2 = Math.max(r.from.row, r.to.row);\r\n    const c1 = Math.min(r.from.col, r.to.col);\r\n    const c2 = Math.max(r.from.col, r.to.col);\r\n    return { r1, r2, c1, c2 };\r\n  }\r\n\r\n  private rangeToA1(r1: number, c1: number, r2: number, c2: number) {\r\n    const start = `${this.colToLetter(c1)}${r1 + 1}`;\r\n    const end = `${this.colToLetter(c2)}${r2 + 1}`;\r\n    return r1 === r2 && c1 === c2 ? start : `${start}:${end}`;\r\n  }\r\n\r\n  addSumOverSelection() {\r\n    const sel = this.getFirstSelectionRange();\r\n    if (!sel) return;\r\n    // If selection is a single cell (likely current cell), default to summing the column above it (skip row 0 header)\r\n    if (sel.r1 === sel.r2 && sel.c1 === sel.c2) {\r\n      const col = this.selectedCol;\r\n      const startRow = 1; // assume first row is header in our AOA\r\n      const endRow = Math.max(startRow, this.selectedRow - 1);\r\n      if (endRow >= startRow) {\r\n        const a1col = this.rangeToA1(startRow, col, endRow, col);\r\n        this.formulaText = `=SUM(${a1col})`;\r\n        this.applyFormulaBar();\r\n        return;\r\n      }\r\n    }\r\n    // If current cell is inside the selected range, exclude it to avoid circular reference\r\n    const within = this.selectedRow >= sel.r1 && this.selectedRow <= sel.r2 && this.selectedCol >= sel.c1 && this.selectedCol <= sel.c2;\r\n    const sumArgs = within\r\n      ? this.buildSumArgsExcludingActive(sel.r1, sel.c1, sel.r2, sel.c2, this.selectedRow, this.selectedCol)\r\n      : this.rangeToA1(sel.r1, sel.c1, sel.r2, sel.c2);\r\n    this.formulaText = `=SUM(${sumArgs})`;\r\n    this.applyFormulaBar();\r\n  }\r\n\r\n  addAvgOverSelection() {\r\n    const sel = this.getFirstSelectionRange();\r\n    if (!sel) return;\r\n    if (sel.r1 === sel.r2 && sel.c1 === sel.c2) {\r\n      const col = this.selectedCol;\r\n      const startRow = 1;\r\n      const endRow = Math.max(startRow, this.selectedRow - 1);\r\n      if (endRow >= startRow) {\r\n        const a1col = this.rangeToA1(startRow, col, endRow, col);\r\n        this.formulaText = `=AVERAGE(${a1col})`;\r\n        this.applyFormulaBar();\r\n        return;\r\n      }\r\n    }\r\n    const within = this.selectedRow >= sel.r1 && this.selectedRow <= sel.r2 && this.selectedCol >= sel.c1 && this.selectedCol <= sel.c2;\r\n    const args = within\r\n      ? this.buildSumArgsExcludingActive(sel.r1, sel.c1, sel.r2, sel.c2, this.selectedRow, this.selectedCol)\r\n      : this.rangeToA1(sel.r1, sel.c1, sel.r2, sel.c2);\r\n    this.formulaText = `=AVERAGE(${args})`;\r\n    this.applyFormulaBar();\r\n  }\r\n\r\n  addCountOverSelection() {\r\n    const sel = this.getFirstSelectionRange();\r\n    if (!sel) return;\r\n    if (sel.r1 === sel.r2 && sel.c1 === sel.c2) {\r\n      const col = this.selectedCol;\r\n      const startRow = 1;\r\n      const endRow = Math.max(startRow, this.selectedRow - 1);\r\n      if (endRow >= startRow) {\r\n        const a1col = this.rangeToA1(startRow, col, endRow, col);\r\n        this.formulaText = `=COUNT(${a1col})`;\r\n        this.applyFormulaBar();\r\n        return;\r\n      }\r\n    }\r\n    const within = this.selectedRow >= sel.r1 && this.selectedRow <= sel.r2 && this.selectedCol >= sel.c1 && this.selectedCol <= sel.c2;\r\n    const args = within\r\n      ? this.buildSumArgsExcludingActive(sel.r1, sel.c1, sel.r2, sel.c2, this.selectedRow, this.selectedCol)\r\n      : this.rangeToA1(sel.r1, sel.c1, sel.r2, sel.c2);\r\n    this.formulaText = `=COUNT(${args})`;\r\n    this.applyFormulaBar();\r\n  }\r\n\r\n  // Build comma-separated SUM arguments covering a rectangle but excluding the active cell\r\n  private buildSumArgsExcludingActive(r1: number, c1: number, r2: number, c2: number, ar: number, ac: number): string {\r\n    const parts: string[] = [];\r\n    // Top block (rows above active row)\r\n    if (ar - 1 >= r1) {\r\n      parts.push(this.rangeToA1(r1, c1, ar - 1, c2));\r\n    }\r\n    // Bottom block (rows below active row)\r\n    if (ar + 1 <= r2) {\r\n      parts.push(this.rangeToA1(ar + 1, c1, r2, c2));\r\n    }\r\n    // Same row: left segment\r\n    if (ac - 1 >= c1) {\r\n      parts.push(this.rangeToA1(ar, c1, ar, ac - 1));\r\n    }\r\n    // Same row: right segment\r\n    if (ac + 1 <= c2) {\r\n      parts.push(this.rangeToA1(ar, ac + 1, ar, c2));\r\n    }\r\n    // Fallback if nothing was added (shouldn't happen unless selection is single cell)\r\n    return parts.filter(Boolean).join(',');\r\n  }\r\n\r\n  // ===== Find panel logic using Handsontable Search plugin =====\r\n  openFindPanel() {\n    this.showFind = true;\n    this.focusFindInput();\n  }\n  closeFindPanel() {\n    this.showFind = false;\n    this.clearFind();\n  }\n  runFind() {\n    if (!this.hot) return;\n    const shouldRefocus = this.isFindInputFocused();\n    // Use search plugin\n    // @ts-ignore\n    const search = this.hot.getPlugin('search');\n    const query = this.findQuery || '';\n    const cmp = (q: string, value: any) => {\n      if (!q) return false;\n      const val = value == null ? '' : String(value);\n      if (this.findCaseSensitive) return val.indexOf(q) !== -1;\n      return val.toLowerCase().indexOf(q.toLowerCase()) !== -1;\n    };\n    const results = search.query(query, undefined, (qStr: string, value: any) => cmp(qStr, value)) || [];\n    this.findResults = results.map((r: any) => ({ row: r.row, col: r.col }));\n    this.currentFindIndex = 0;\n    if (this.findResults.length) this.gotoFindIndex(0, shouldRefocus);\n    else if (shouldRefocus) this.focusFindInput();\n    this.hot.render();\n  }\n  clearFind() {\r\n    this.findQuery = '';\r\n    this.findResults = [];\r\n    this.currentFindIndex = 0;\r\n    if (this.hot) {\r\n      // Clear highlights by running empty query\r\n      // @ts-ignore\r\n      const search = this.hot.getPlugin('search');\r\n      search.query('');\r\n      this.hot.render();\r\n    }\r\n  }\r\n  gotoFindIndex(idx: number, refocus = false) {\n    if (!this.hot || !this.findResults.length) return;\n    const hadFindFocus = refocus || this.isFindInputFocused();\n    const n = this.findResults.length;\n    this.currentFindIndex = ((idx % n) + n) % n; // wrap\n    const { row, col } = this.findResults[this.currentFindIndex];\n    this.hot.selectCell(row, col, row, col, true, true);\n    this.updateSelection(row, col);\n    if (hadFindFocus) this.focusFindInput();\n  }\n  nextFind() { this.gotoFindIndex(this.currentFindIndex + 1); }\n  prevFind() { this.gotoFindIndex(this.currentFindIndex - 1); }\n\n  private isFindInputFocused() {\n    const active = typeof document !== 'undefined' ? document.activeElement : null;\n    return !!(this.findInput?.nativeElement && active === this.findInput.nativeElement);\n  }\n\n  private focusFindInput() {\n    setTimeout(() => this.findInput?.nativeElement?.focus(), 0);\n  }\n\n  replaceCurrent() {\n    if (!this.hot || !this.findQuery) return;\n    if (!this.findResults.length) {\n      this.runFind();\n      if (!this.findResults.length) return;\n    }\n    const { row, col } = this.findResults[this.currentFindIndex];\n    const currentValue = this.hot.getDataAtCell(row, col);\n    const next = this.buildReplacement(String(currentValue ?? ''), false);\n    if (next === null) return;\n    this.hot.setDataAtCell(row, col, next);\n    this.hot.render();\n    this.runFind();\n  }\n\n  replaceAllMatches() {\n    if (!this.hot || !this.findQuery) return;\n    const rows = this.hot.countRows?.() ?? 0;\n    const cols = this.hot.countCols?.() ?? 0;\n    if (!rows || !cols) return;\n    let didReplace = false;\n    for (let r = 0; r < rows; r++) {\n      for (let c = 0; c < cols; c++) {\n        const value = this.hot.getDataAtCell(r, c);\n        const next = this.buildReplacement(String(value ?? ''), true);\n        if (next !== null) {\n          this.hot.setDataAtCell(r, c, next);\n          didReplace = true;\n        }\n      }\n    }\n    if (didReplace) {\n      this.hot.render();\n    }\n    this.runFind();\n  }\n\n  private buildReplacement(value: string, allOccurrences: boolean): string | null {\n    const query = this.findQuery;\n    if (!query) return null;\n    const flags = this.findCaseSensitive ? '' : 'i';\n    const escaped = this.escapeRegExp(query);\n    const re = new RegExp(escaped, allOccurrences ? `g${flags}` : flags);\n    if (!re.test(value)) return null;\n    re.lastIndex = 0; // reset for reuse\n    return value.replace(re, this.replaceText ?? '');\n  }\n\n  private escapeRegExp(str: string): string {\n    return str.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n  }\n  \r\n  // Ensure cells are primitives acceptable by Handsontable/HyperFormula\r\n  private sanitizeCell(value: any): string | number | boolean | null {\r\n    if (value === null || value === undefined) return '';\r\n    if (Array.isArray(value)) return value.join(', ');\r\n    const t = typeof value;\r\n    if (t === 'string' || t === 'number' || t === 'boolean') return value as any;\r\n    if (value instanceof Date) return value.toISOString();\r\n    try {\r\n      return JSON.stringify(value);\r\n    } catch {\r\n      return String(value);\r\n    }\r\n  }\r\n\r\n  private sanitizeAoa(aoa: any[][]): (string | number | boolean | null)[][] {\r\n    return (aoa || []).map(row => Array.isArray(row) ? row.map(c => this.sanitizeCell(c)) : [this.sanitizeCell(row)]);\r\n  }\r\n\r\n  // Remove leading entirely empty rows so the header is at the very top\r\n  private trimLeadingEmptyRows(aoa: (string | number | boolean | null)[][]): (string | number | boolean | null)[][] {\r\n    const isEmpty = (v: any) => v === '' || v === null || v === undefined;\r\n    let start = 0;\r\n    while (start < (aoa?.length || 0)) {\r\n      const row = aoa[start] || [];\r\n      if (row.some(cell => !isEmpty(cell))) break;\r\n      start++;\r\n    }\r\n    return (aoa || []).slice(start);\r\n  }\r\n\r\n  \r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes['data'] || changes['columns'] || changes['sheetName']) {\r\n      console.log('changes', changes)\r\n      if (Array.isArray(this.data) && this.data.length > 0) {\r\n        this.setSheetFromObjects(this.data, this.columns, this.sheetName || 'Sheet1');\r\n      } else if (Array.isArray(this.data) && this.data.length === 0) {\r\n        // If explicitly passed empty data, clear the table\r\n        this.excelData = [];\r\n        this.workbook = undefined;\r\n        this.sheetNames = [];\r\n        this.selectedSheet = '';\r\n      }\r\n    }\r\n  }\r\n\r\n  setSheetFromObjects(rows: any[], cols?: { field: string; header?: string }[], name: string = 'Sheet1') {\r\n    const resolvedCols = cols && cols.length\r\n      ? cols.map(c => ({ field: c.field, header: c.header || c.field }))\r\n      : Object.keys(rows[0] || {}).map(k => ({ field: k, header: k }));\r\n\r\n    const excludes = (this.excludeColumns || []).map(e => String(e).toLowerCase());\r\n    const filteredCols = resolvedCols.filter(c => {\r\n      const f = (c.field || '').toString().toLowerCase();\r\n      const h = (c.header || '').toString().toLowerCase();\r\n      return !(excludes.includes(f) || excludes.includes(h));\r\n    });\r\n    const finalCols = filteredCols.length > 0 ? filteredCols : resolvedCols;\r\n\r\n    const headerRow = finalCols.map(c => c.header);\r\n    const dataRows = rows.map(r => finalCols.map(c => this.sanitizeCell(r?.[c.field])));\r\n    const aoa = [headerRow, ...dataRows];\r\n    const clean = this.sanitizeAoa(aoa);\r\n    this.excelData = (clean && clean.length) ? clean : [['']];\r\n    this.workbook = undefined;\r\n    this.sheetNames = [name];\r\n    this.selectedSheet = name;\r\n  }\r\n\r\n  onFileChange(event: Event): void {\r\n    const file = (event.target as HTMLInputElement).files?.[0];\r\n    (event.target as HTMLInputElement).value = ''; \r\n    if (!file) return;\r\n\r\n    const reader = new FileReader();\r\n    reader.onload = (e: any) => {\r\n      const data = new Uint8Array(e.target.result);\r\n      this.workbook = XLSX.read(data, { type: 'array' });\r\n\r\n      this.sheetNames = this.workbook.SheetNames ?? [];\r\n      this.selectedSheet = this.sheetNames[0] ?? '';\r\n\r\n      if (!this.selectedSheet) {\r\n        this.excelData = [];\r\n        return;\r\n      }\r\n      this.loadSheet(this.selectedSheet);\r\n    };\r\n    reader.readAsArrayBuffer(file);\r\n  }\r\n\r\n  loadSheet(sheetName: string): void {\r\n    if (!this.workbook) return;\r\n    const ws = this.workbook.Sheets[sheetName];\r\n    const aoa = XLSX.utils.sheet_to_json<any[]>(ws, { header: 1 }) as any[][];\r\n    const clean = this.sanitizeAoa(aoa);\r\n    const trimmed = this.trimLeadingEmptyRows(clean);\r\n    this.excelData = (trimmed && trimmed.length) ? trimmed : [['']];\r\n  }\r\n\r\n  onSheetChange(event: Event): void {\r\n    const sheet = (event.target as HTMLSelectElement).value;\r\n    this.selectedSheet = sheet;\r\n    this.loadSheet(sheet);\r\n  }\r\n\r\n  downloadExcel(): void {\r\n    const wb = XLSX.utils.book_new();\r\n    const ws = XLSX.utils.aoa_to_sheet(this.excelData);\r\n    const name = this.selectedSheet || this.sheetName || 'Sheet1';\r\n    XLSX.utils.book_append_sheet(wb, ws, name);\r\n\r\n    const buf = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });\r\n    const blob = new Blob([buf], { type: 'application/octet-stream' });\r\n    saveAs(blob, 'updated_excel.xlsx');\r\n  }\r\n}\r\n\r\n","<div class=\"container\">\r\n  <div class=\"upload-section\" *ngIf=\"!hideUpload\">\r\n    <label for=\"file-upload\" class=\"upload-btn\">Upload Excel</label>\r\n    <input type=\"file\" id=\"file-upload\" accept=\".xlsx,.xls,.csv\" (change)=\"onFileChange($event)\" hidden />\r\n    <button class=\"download-btn\" (click)=\"downloadExcel()\" [disabled]=\"!excelData.length\">Download Updated Excel</button>\r\n  </div>\r\n\r\n  <div *ngIf=\"sheetNames.length > 1\" class=\"sheet-selector\">\r\n    <label for=\"sheetSelect\">Select Sheet:</label>\r\n    <select id=\"sheetSelect\" (change)=\"onSheetChange($event)\" [value]=\"selectedSheet\">\r\n      <option *ngFor=\"let sheet of sheetNames\" [value]=\"sheet\">{{ sheet }}</option>\r\n    </select>\r\n  </div>\r\n\r\n  <div *ngIf=\"excelData.length > 0\" class=\"excel-wrapper\" [ngStyle]=\"{ width: containerWidth }\">\r\n    <div class=\"excel-toolbar\">\r\n      <button type=\"button\" class=\"tlb-btn\" title=\"Bold\" (click)=\"toggleBold()\"><strong>B</strong></button>\r\n      <div class=\"tlb-sep\"></div>\r\n      <button type=\"button\" class=\"tlb-btn\" title=\"Align left\" (click)=\"align('left')\">L</button>\r\n      <button type=\"button\" class=\"tlb-btn\" title=\"Align center\" (click)=\"align('center')\">C</button>\r\n      <button type=\"button\" class=\"tlb-btn\" title=\"Align right\" (click)=\"align('right')\">R</button>\r\n      <div class=\"tlb-sep\"></div>\r\n      <button type=\"button\" class=\"tlb-btn\" title=\"Wrap text\" (click)=\"toggleWrap()\">Wrap</button>\r\n      <div class=\"tlb-sep\"></div>\r\n      <button type=\"button\" class=\"tlb-btn\" title=\"AutoSum (Alt+=)\" (click)=\"addSumOverSelection()\">Sum</button>\r\n      <button type=\"button\" class=\"tlb-btn\" title=\"Average\" (click)=\"addAvgOverSelection()\">Avg</button>\r\n      <button type=\"button\" class=\"tlb-btn\" title=\"Count\" (click)=\"addCountOverSelection()\">Cnt</button>\r\n      <div class=\"tlb-grow\"></div>\r\n      <input class=\"name-box\" [value]=\"nameBox\" readonly aria-label=\"Cell address\" />\n      <input class=\"formula-input\" [(ngModel)]=\"formulaText\" (keyup.enter)=\"applyFormulaBar()\" (blur)=\"applyFormulaBar()\" placeholder=\"fx\" aria-label=\"Formula bar\" />\n      <button type=\"button\" class=\"tlb-btn\" title=\"Find (Ctrl+F)\" (click)=\"openFindPanel()\">Find</button>\n      <div class=\"find-panel\" *ngIf=\"showFind\">\n        <input #findInput class=\"find-input\" [(ngModel)]=\"findQuery\" (input)=\"runFind()\" (keyup.enter)=\"nextFind()\" placeholder=\"Find...\" />\n        <input class=\"replace-input\" [(ngModel)]=\"replaceText\" placeholder=\"Replace with...\" />\n        <label class=\"find-opt\"><input type=\"checkbox\" [(ngModel)]=\"findCaseSensitive\" (change)=\"runFind()\" /> Case</label>\n        <span class=\"find-count\">{{ findResults.length ? (currentFindIndex + 1) + '/' + findResults.length : '0/0' }}</span>\n        <button type=\"button\" class=\"tlb-btn\" (click)=\"prevFind()\">Prev</button>\n        <button type=\"button\" class=\"tlb-btn\" (click)=\"nextFind()\">Next</button>\n        <button type=\"button\" class=\"tlb-btn\" (click)=\"replaceCurrent()\" [disabled]=\"!findQuery\">Replace</button>\n        <button type=\"button\" class=\"tlb-btn\" (click)=\"replaceAllMatches()\" [disabled]=\"!findQuery\">Replace All</button>\n        <button type=\"button\" class=\"tlb-btn\" (click)=\"closeFindPanel()\">Close</button>\n      </div>\n    </div>\n    <div class=\"table-container\" [ngStyle]=\"{ height: containerHeight }\">\n      <hot-table #hotRef [hotId]=\"hotId\" class=\"hot-full\"\n        [data]=\"excelData\" [rowHeaders]=\"true\" [colHeaders]=\"true\"\n        [dropdownMenu]=\"true\" [filters]=\"true\" [search]=\"true\"\n        [contextMenu]=\"contextMenu\" [formulas]=\"formulas\" [licenseKey]=\"licenseKey\"\r\n        [copyPaste]=\"false\"\r\n        [stretchH]=\"'all'\" [manualColumnResize]=\"true\" [manualRowResize]=\"true\"\r\n        [manualColumnMove]=\"true\" [manualRowMove]=\"true\" [columnSorting]=\"true\"\r\n        [fillHandle]=\"true\" [fixedRowsTop]=\"headerRows\" [fixedColumnsLeft]=\"0\"\r\n        [outsideClickDeselects]=\"false\" [currentRowClassName]=\"'currentRow'\"\r\n        [currentColClassName]=\"'currentCol'\">\n      </hot-table>\n    </div>\n    <div class=\"status-bar\" aria-live=\"polite\">\n      <ng-container *ngIf=\"!selectionStats.hasNonNumeric && selectionStats.numericCount > 0; else countOnly\">\n        <div class=\"status-item\">\n          <span class=\"status-label\">Average</span>\n          <span class=\"status-value\">{{ selectionStats.average !== null ? (selectionStats.average | number:'1.0-4') : '—' }}</span>\n        </div>\n        <div class=\"status-item\">\n          <span class=\"status-label\">Count</span>\n          <span class=\"status-value\">{{ selectionStats.count }}</span>\n        </div>\n        <div class=\"status-item\">\n          <span class=\"status-label\">Sum</span>\n          <span class=\"status-value\">{{ selectionStats.numericCount ? (selectionStats.sum | number:'1.0-4') : '—' }}</span>\n        </div>\n      </ng-container>\n      <ng-template #countOnly>\n        <div class=\"status-item\">\n          <span class=\"status-label\">Count</span>\n          <span class=\"status-value\">{{ selectionStats.count }}</span>\n        </div>\n      </ng-template>\n    </div>\n  </div>\n</div>\n","import { NgModule } from '@angular/core';\nimport { ExcelifyComponent } from './excelify.component';\n\n@NgModule({\n  imports: [ExcelifyComponent],\n  exports: [ExcelifyComponent],\n})\nexport class ExcelifyModule {}\n","/*\n * Public API Surface of excelify\n */\n\nexport * from './lib/excelify.component';\nexport * from './lib/excelify.module';","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}